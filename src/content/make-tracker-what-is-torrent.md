---
templateKey: blog-post
id: 114154c0-4c6a-11ea-adba-f5973d0ff94c
title: "[트래커를 만들어보자] 1. 토렌트란 무엇인가"
slug: /2020/2/11/make-tracker-what-is-torrent
description: '비트토렌트 트래커 만들기 1화'
tags:
  - uncategorized
  - javascript
headerImage: '/images/bittorrent.png'
date: 2020-02-11T01:01:42.795Z
---

문득 트래커를 만들어 보고싶었다. 예전에 토렌트를 한창 썼을때 매번 토렌트를 쓸 때마다, 'yyyy년 mm월 트래커 리스트' 이런식으로 써있는 데에서,  
알 수 없는 사이트 목록을 트래커랍시고 복사해다가 다운로드 받아야할 토렌트 파일에 붙여넣기를 하곤 했다.

뭐 굳이 알아야하냐? 하면 할말은 없지만 아는 것이 힘! 이라 하였는데, 한번 직접 만들어보면서 토렌트가 어떻게 돌아가는지 알아보고자 했다.

먼저, 트래커를 만들기 전에 토렌트란 뭔가? 그리고, 토렌트 네트워크의 참가자는 누구인가?

그리고, 토렌트가 p2p 공유 중 하나이고, 기본적인 공유방식을 안다하면, 실제 비트토렌트 프로토콜의 정의와, 어떤 request, response 를 주고받는지에 대해 알아볼 것이다.

이 글은 이러한 이야기를 하기에 앞서 알아야할 전제조건인, '토렌트와 p2p 네트워크 에 대해서' 간단하게 언급해볼 것이다.

---

# 먼저, P2P 란 무엇인가?

비트토렌트 프로토콜은(토렌트) P2P 통신망을 구축하고 이 위에서 데이터를 주고받는 통신규약이라고 할 수 있다.  
그럼 P2P 란 무엇인가?

우리가 보통 어떤 데이터를 서버에게서 받을때의 통신망은 아래와 같이 볼 수 있다.

![server_client](/images/server_client.png)

뭐 게임을해도, 웹사이트를 접속해도 기본적으로 서버가 존재하고 서버에서 데이터를 받는 구조이다.

클라이언트들이 많아질수록 서버는 부담이 많아질 것이다.

이와는 다르게, 모든 네트워크 내 참여자가 부담을 분산하고, 서로 데이터를 공유하는 형태가 바로 P2P(Peer to Peer) 네트워크이다.

![peer_to_peer](/images/peer_network.png)

P2P 네트워크는 위와 같은 구조라고 보면 된다. 네트워크 내 참여자가 서버이면서 클라이언트가 된다.  
이 경우, 전체 네트워크의 부담은 각 참여자의 처리능력과 대역폭에 의해 결정될 것이다.

# 그래서, 토렌트는 무엇인가?

토렌트는 P2P 네트워크를 정의하고 데이터를 공유하는 하나의 규약이다.  
정확하게는 비트토렌트 프로토콜을 뜻한다. 비트토렌트는 [브람 코헨](https://ko.wikipedia.org/wiki/%EB%B8%8C%EB%9E%A8_%EC%BD%94%EC%96%B8) 에 의해 만들어졌다.

어떻게 보면 이 비트토렌트 프로토콜을 통해 파일을 공유하는 프로그램을 뜻할 수도 있겠다. 비트토렌트 프로그램을 포함해, uTorrent, deluge 같은 프로그램들 말이다.

그러므로 토렌트라는 것은, '비트토렌트 규약을 통해 서로 데이터를 공유할 수 있는 P2P 네트워크' 정도라고 생각하면 될 것 같다.

# 토렌트에서 사용되는 키워드들

### Peer
토렌트 네트워크에 참가한 모든 유저를 뜻한다. 이 유저는 두가지로 분류된다.

- Seeder : 시더는 온전한 파일 자체를 가지고 있어서 최종적인 배포가 가능한 유저이다.  
  만약 자신이 알고있는 피어중 시더가 한명도 없다면 이 파일은 완전히 다운받지 못할 것이다.
  
- Leecher : 리처는 그 반대이다. 파일의 조각을 가지고있거나, 하나도 없어서 공유를 받아야할 존재이다.  
  물론 리처도 자신이 가지고 있는 조각에 한해서는 공유가 가능하므로, 리처가 많으면 파일을 완전히 받지는 못할망정,
  그 전까지는 많은 이들에게 빠르게 조각을 받을 수 있을 것이다.

### torrent file
어떤 파일목록을 받아야할지, 어디서 피어목록을 요청해야할지등 네트워크 참가에 필요한 정보를 담은 파일이다.  
이 파일을 실행시키면 토렌트 프로그램은 파일에 기록된 정보를 통해 네트워크에 참가하고 피어들과 소통하게 된다.

### Magnet
토렌트파일이 파일로서 정보를 기록했다면, 마그넷은 url 주소로서 이 정보를 기록한 형태이다.  
파일을 굳이 가지고 있지 않더라도 링크를 실행시키는 것으로 토렌트 프로그램이 토렌트 파일을 실행시킨것과 같은 동작을 할 수 있다.
  
### Tracker
특정 파일군 별 피어목록들을 관리해주는 일종의 서버이다. P2P 는 서버가 없다고 했는데.. 서버가 있다?

물론 실제 공유 동작에서 트래커는 아무일도 하지 않는다.

하지만 먼저 파일을 공유하기에 앞서, 어떤 이들과 파일을 공유해야할지, 어떤이들에게 조각을 요청해야할지 어떻게 알겠는가?  
그렇기 때문에 한번은 이 트래커라는 곳에 방문해 토렌트 파일에 기록된 값을 보여주며, '이 값과 같은 정보를 공유중인 애들을 알려줘' 하고 물어보는 것이다.

이 트래커는 모두가 접근할 수 있도록 공개되어있을 수도, 특정 피어들끼리만 공유하도록 폐쇄적으로 운영되고 있을수도 있다.

---

이정도면 기본적으로 토렌트가 무엇인지 정도는 알 수 있지 않나 싶다.

다음 글에서는, 직접 비트토렌트 프로토콜을 확인하고

이 프로토콜에 맞춰 http 기반 tracker 서버를 구축해볼 예정이다. (트래커는 http, ws, udp 프로토콜을 사용할 수 있다.)

기술스택은 최근 업무에 사용중인 Nodejs + Typescript 로 해볼 생각이다.
